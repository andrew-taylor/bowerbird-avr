<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MyUSB Library: Migrating from V1.5.2 to 1.5.3</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="Page_Migration152">Migrating from V1.5.2 to 1.5.3 </a></h1>Below is migration information for updating existing projects based on the MyUSB library version 1.5.2 to the 1.5.3 API. It does not indicate all new additions to the library, only areas relevant to making older projects compatible with the new API.<p>
<b>Library Demos</b><ul>
<li>Previously, all demos contained a serial number string descriptor, filled with all zeros. A serial number string is required in Mass Storage devices, or devices which are to retain settings when moved between ports on a machine. As people were not changing the serial number value, this was causing conflicts and so the serial number descriptor has been removed from all but the Mass Storage demo, which requires it.</li><li>The AudioOut and AudioIn demos did not previously silence their endpoints when the host has deactivated them. Projects built upon either demo should upgrade to the latest code.</li><li>The FEATURE_ENDPOINT macro has been renamed FEATURE_ENDPOINT_HALT, and is now correctly documented.</li><li>The MassStoreHost demo contained errors which caused it to lock up randomly on certain devices. Projects built on the MassStoreDemo code should update to the latest version.</li><li>The Interrupt type endpoint in the CDC based demos previously had a polling interval of 0x02, which caused problems on some Linux systems. This has been changed to 0xFF, projects built on the CDC demos should upgrade to the latest code.</li><li>The HID keyboard and mouse demos were not previously boot mode compatible. To enable boot mode support, projects built on the keyboard or mouse demos (or derivatives) should upgrade to the latest code.</li><li>The Mass Storage demo was not previously standards compliant. Projects built on the Mass Storage demo should upgrade to the latest code.</li><li>The USART was not being reconfigured after the host sent new encoding settings in the USBtoSerial demo. This was previously discovered and fixed, but the change was lost. Projects built on the USBtoSerial demo should update to the latest code.</li></ul>
<p>
<b>Device Mode</b><ul>
<li>The endpoint non-control stream functions now have a default timeout of 50ms between packets in the stream. If this timeout is exceeded, the function returns the new ENDPOINT_RWSTREAM_ERROR_Timeout error value. The timeout value can be overridden by defining the USB_STREAM_TIMEOUT_MS in the project makefile to the desired timeout duration in ms.</li><li>Rather than returning fixed values, the flags indicating if the device has Remote Wakeup currently enabled and/or is self-powered are now accessed and set through the new USB_RemoteWakeupEnabled and USB_CurrentlySelfPowered macros. See the <a class="el" href="db/df3/a00034.html">DevChapter9.h</a> documentation for more details.</li><li>All endpoint stream functions now require an extra Callback function parameter. Existing code may be updated to either supply NO_STREAM_CALLBACK as the extra parameter, or disable stream callbacks altogether by pasing the token NO_STREAM_CALLBACKS to the compiler using the -D switch.</li></ul>
<p>
<b>Host Mode</b><ul>
<li>The pipe non-control stream functions now have a default timeout of 50ms between packets in the stream. If this timeout is exceeded, the function returns the new PIPE_RWSTREAM_ERROR_Timeout error value. The timeout value can be overridden by defining the USB_STREAM_TIMEOUT_MS in the project makefile to the desired timeout duration in ms.</li><li>CollectionPath_t has been renamed to HID_CollectionPath_t to be more in line with the other HID parser structures.</li><li>All pipe stream functions now require an extra Callback function parameter. Existing code may be updated to either supply NO_STREAM_CALLBACK as the extra parameter, or disable stream callbacks altogether by pasing the token NO_STREAM_CALLBACKS to the compiler using the -D switch. </li></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Oct 2 18:01:18 2008 for MyUSB Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
